---
title: "Crunching Function for XlsForm"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{crunching-function-for-xlsform}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(kobocruncher)
```

<!-- WARNING - This vignette is generated by {fusen} from /dev/flat_dev.Rmd: do not edit by hand -->

# Data examples to demo the package

<!-- 
 Store your dataset in a directory named "inst/" at the root of your project.
 Use it for your tests in this Rmd thanks to `pkgload::load_all()` to make it available
and `system.file()` to read it in your examples.
-->


# Data loading

```{r examples-kobo_data}
datalist <- kobo_data(datapath = system.file("data.xlsx", package = "kobocruncher") )
# MainFrame
datalist[1]
# Second Frame
datalist[2]  
```

# Prepare data dictionnary

```{r examples-kobo_dico}
dico <- kobo_dico( xlsformpath = system.file("sample_xlsform.xlsx", package = "kobocruncher") )
# Survey
questions <- as.data.frame(dico[1])
knitr::kable(head(questions, 10))
# Choices
responses <- as.data.frame(dico[2])
knitr::kable(head(responses, 10))
# Settings
metadata <- as.data.frame(dico[3])
knitr::kable(head(metadata, 10))
```

# Get frame for a variable

```{r examples-kobo_frame}
data <- kobo_frame(datapath = system.file("data.xlsx", package = "kobocruncher"),
                   xlsformpath = system.file("sample_xlsform.xlsx", package = "kobocruncher"),
                   var = "members.sex"   )
knitr::kable(head(data,5))
 
```

# Get the label for a specific variable

```{r examples-label_varname}

label_varname(xlsformpath = system.file("sample_xlsform.xlsx", package = "kobocruncher"), 
              x ="profile.country")

```

# Get interpretation hint for a specific variable

```{r examples-label_varhint}
label_varhint(xlsformpath = system.file("sample_xlsform.xlsx", package = "kobocruncher"), 
              x ="profile.country")
```

# Get all the choices labels options for a specific variable

```{r examples-label_choiceset}
label_choiceset(xlsformpath =  system.file("sample_xlsform.xlsx", package = "kobocruncher"), 
                x="profile.country")
```

# Get the label for a specific choice if available

```{r examples-label_choice}
label_choice(xlsformpath =  system.file("sample_xlsform.xlsx", package = "kobocruncher"), 
              x = "profile.country")

```

# Plotting Select one variable

```{r examples-plot_select_one}
plot_select_one(datapath = system.file("data.xlsx", package = "kobocruncher"),
              xlsformpath =  system.file("sample_xlsform.xlsx", package = "kobocruncher"), 
              var = "profile.country")
```

# Plotting Select one variable with Crosstabulation

```{r examples-plot_select_one_cross}
plot_select_one_cross(datapath = system.file("data.xlsx", package = "kobocruncher"),
              xlsformpath =  system.file("sample_xlsform.xlsx", package = "kobocruncher"), 
              var = "profile.country",
              crosstab = "profile.occupation"
              )
```

# Plotting Select multiple variable

```{r examples-plot_select_multiple}
plot_select_multiple(datapath = system.file("data.xlsx", package = "kobocruncher"),
              xlsformpath =  system.file("sample_xlsform.xlsx", package = "kobocruncher"), 
              var = "profile.reason"
            )
```

# Plotting Select multiple variable with cross-tabulation

```{r examples-plot_select_multiple_cross}
plot_select_multiple_cross(datapath = system.file("data.xlsx", package = "kobocruncher"),
              xlsformpath =  system.file("sample_xlsform.xlsx", package = "kobocruncher"), 
              var = "profile.reason",
              crosstab = "location")
```

# Plotting Numeric variable

```{r examples-plot_integer}
plot_integer(datapath = system.file("data.xlsx", package = "kobocruncher"),
              xlsformpath =  system.file("sample_xlsform.xlsx", package = "kobocruncher"), 
              var = "members.age")
```

# Plotting Open Text variable

```{r examples-plot_text}
plot_text(datapath = system.file("data.xlsx", package = "kobocruncher"),
              xlsformpath =  system.file("sample_xlsform.xlsx", package = "kobocruncher"), 
              var = "profile.occupation")
```

# Output Header variable

```{r examples-output_header}
output_header( xlsformpath =  system.file("sample_xlsform.xlsx", package = "kobocruncher"), 
              var = "profile")
```

# Crunching Variable based on type

```{r examples-kobo_cruncher}
kobo_cruncher(datapath = system.file("data.xlsx", package = "kobocruncher"),
              xlsformpath =  system.file("sample_xlsform.xlsx", package = "kobocruncher"), 
              type = "select_one", 
              name = "profile.country",
              showcode = TRUE)
```

 


# Report Template 1 for Automatic Data Exploration

# Report Template 2 for Joint Data Interpretation Session

# Report Template 3 for Dissemination and Data Story Telling Template

