---
title: "Data Interpretation Session"
subtitle: "Based on Key Research Questions"
author: "Your name"
date: "`r format(Sys.Date(),  '%d %B %Y')`"
output:
  unhcrdown::pptx_slides
params:
  datafolder: "data-raw"
  data: "data.xlsx"
  form: "form.xlsx"
  datasource: ""
---
<!--
Please use this template only once you have completed the data exploration steps and configured all the steps for the initial data analysis plan 
-->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      message = FALSE, 
                      warning = FALSE,
                      collapse = FALSE,
                      comment = "#>",
                      # fig.width = 5.5, fig.height = 4,
                      fig.retina = 2, 
                      fig.width = 9,
                      fig.asp = 0.618,
                      fig.align = "center",
                      dev = "ragg_png",
                      out.width = "90%")
options(scipen = 999) # turn-off scientific notation like 1e+48
set.seed(1)
extrafont::loadfonts(quiet=TRUE)

library("tidyverse")
library("kobocruncher")
library("officedown")
library(unhcrthemes)
library(ggplot2)
library(rvg)
library(tidyverse)
library(scales)
library(lubridate)

# turn off the automatic use of showtext functionality, so that the dml function can works properly
showtext::showtext_auto(FALSE) 
```

```{r  }
## The 2 lines below are for the demo - please comment the 2 below 
# and uncomment the one after once you have set up your report parameters..
datapath <- system.file("data.xlsx", package = "kobocruncher")
xlsformpath <-  system.file("sample_xlsform.xlsx", package = "kobocruncher")
# datapath <- here::here(params$datafolder, params$data)
# xlsformpath <- here::here(params$datafolder, params$form) 

datalist <- kobo_data(datapath = datapath )
dico <- kobo_dico(xlsformpath = xlsformpath)
questions <- as.data.frame(dico[1])
```

## Joint Data Interpretation  

The Joint Data Interpretation allows to make sense of the data.

The interpretation can make use of the "__Protection Risk Equation__" Analysis (See [Protection Gap Framework for Analysis](https://www.unhcr.org/50aa57ad9.pdf)) to look at 1) Harmful, discriminatory and/or protective contextual factors, 2) Current threats to the population, 3) Rights violations and abuses, 4) Threat effect on the population and 5) Existing capacities to address protection threats .

 

---

```{r ph=officer::ph_location_fullsize()}
## here you can paste selected charts from the intial exploration phase...
plot_select_one(datalist = datalist, dico = dico, "location")-> p
dml(ggobj = p, fonts = list(serif = 'Lato'))
```



---

```{r ph=officer::ph_location_fullsize()}
## here you can paste selected charts from the intial exploration phase...
 plot_integer(datalist = datalist, dico = dico, "members.age") -> p
dml(ggobj = p, fonts = list(serif = 'Lato'))
```



---
 

## Columns & Images

:::::: {.columns}
::: {.column}
Content of the left column.

*  list 1
*  list 2
:::

::: {.column}
Content of the right column.

1.  list 1
2.  list 2
:::
::::::







```{r}
### Time to archive your work once done!! 
### Uncomment and Run this only once you have knitted your file in order to quickly upload this to RIDL -
# https://galalh.github.io/riddle/reference/resource.html
# remotes::install_github("galalH/riddle")

## Enter below the name you used to save this file - without extension
# name_of_this_file <- "interpretation"
# 
# metadatareport <- riddle::resource_metadata(type = "attachment",
#                                         url = paste0(params$datasource,"_Interpretation.pptx"),
#                                         name = paste0(params$datasource,"_Interpretation"),
#                                         description = "Interpretation Presentation Generated with kobocruncher",
#                                         format = "pptx",
#                                         visibility =  "public",
#                                         file_type = "report",
#                                         ## Revise here based on the name from your crunching report
#                                         upload = here::here(paste0(name_of_this_file,".pptx")) 
#                                       )
# riddle::resource_create(params$datasource, metadatareport)
# 
# metadataanalysisplan <- riddle::resource_metadata(type = "attachment",
#                                         url = paste0(params$datasource,"_analysisPlan.xlsx"),
#                                         name = paste0(params$datasource,"_analysisPlan"),
#                                         description = "Analysis Plan to use with kobocruncher",
#                                         format = "xlsx",
#                                         visibility =  "public",
#                                         file_type = "other",
#                                         ## Revise here based on the name from your crunching report
#                                         upload =  here::here(params$datafolder, params$form) 
#                                       )
# riddle::resource_create(params$datasource, metadataanalysisplan)
# 
# metadataanalysisscript <- riddle::resource_metadata(type = "attachment",
#                                         url = paste0(params$datasource,"_notebook.Rmd"),
#                                         name = paste0(params$datasource,"_analysisPlan"),
#                                         description = "Notebook using kobocruncher",
#                                         format = "Rmd",
#                                         visibility =  "public",
#                                         file_type = "script",
#                                         ## Revise here based on the name from your crunching report
#                                         upload = here::here(paste0(name_of_this_file,".Rmd")) 
#                                       )
# riddle::resource_create(params$datasource, metadataanalysisscript)


```
